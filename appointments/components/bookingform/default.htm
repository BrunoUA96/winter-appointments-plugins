<div class="booking-container">
    <div class="booking-header mb-4">
        <h1>Marca sua consulta</h1>
        <p>Tem duas formas de marcar sua consulta:</p>
    </div>

    <!-- Tabs Navigation -->
    <ul class="nav nav-tabs d-flex justify-content-center booking-tabs" id="bookingTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button
                class="nav-link active"
                id="presencial-tab"
                data-bs-toggle="tab"
                data-bs-target="#presencial"
                type="button"
                role="tab"
                aria-controls="presencial"
                aria-selected="true"
            >
                Consulta presencial
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button
                class="nav-link"
                id="online-tab"
                data-bs-toggle="tab"
                data-bs-target="#online"
                type="button"
                role="tab"
                aria-controls="online"
                aria-selected="false"
            >
                Consulta online
            </button>
        </li>
    </ul>
    <div class="tab-content booking-tabs-content" id="bookingTabsContent">
        <!-- Online Tab -->
        <div
            class="tab-pane fade"
            id="online"
            role="tabpanel"
            aria-labelledby="online-tab"
        >
            <div class="">
                <div class="">
                    <div class="booking-header">
                        <p>
                            Selecione o hor√°rio mais conveniente para sua
                            consulta
                        </p>
                    </div>
                    <div class="booking-content">
                        <div class="booking-form-section">
                            <form
                                data-request="onSaveBooking"
                                data-request-validate
                                data-request-success="handleSuccess"
                                data-request-error="handleError"
                                data-request-update="'@default': ''"
                                data-request-flash
                                data-request-data="{}"
                            >
                                <div class="form-section">
                                    <h3>Dados pessoais</h3>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="patient_name"
                                                >Seu nome</label
                                            >
                                            <input
                                                type="text"
                                                class="form-control"
                                                id="patient_name"
                                                name="patient_name"
                                                required
                                            />
                                        </div>
                                        <div class="form-group">
                                            <label for="email">Email</label>
                                            <input
                                                type="email"
                                                class="form-control"
                                                id="email"
                                                name="email"
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="phone">Telefone</label>
                                        <input
                                            type="tel"
                                            class="form-control"
                                            id="phone"
                                            name="phone"
                                            required
                                        />
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h3>Tipo de consulta</h3>
                                    <div class="form-group">
                                        <select
                                            class="form-control consultation-select"
                                            id="consultation_type_id"
                                            name="consultation_type_id"
                                            required
                                        >
                                            <option value="">
                                                Selecione o tipo de consulta
                                            </option>
                                            {% for id, name in consultationTypes
                                            %}
                                            <option value="{{ id }}">
                                                {{ name }}
                                            </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h3>Data e hora</h3>
                                    <div class="date-time-row">
                                        <div class="form-group">
                                            <label for="appointment_date"
                                                >Data da consulta</label
                                            >
                                            <input
                                                type="date"
                                                class="form-control date-input"
                                                id="appointment_date"
                                                name="appointment_date"
                                                min="{{ 'now'|date('Y-m-d') }}"
                                                required
                                            />
                                        </div>
                                        <div class="form-group">
                                            <label for="appointment_time"
                                                >Hora da consulta</label
                                            >
                                            <select
                                                class="form-control time-select"
                                                id="appointment_time"
                                                name="appointment_time"
                                                required
                                            >
                                                <option value="">
                                                    Selecione a hora
                                                </option>
                                                {% for time in availableTimes %}
                                                <option
                                                    value="{{ time|date('H:i') }}"
                                                >
                                                    {{ time|date('H:i') }}
                                                </option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h3>Informa√ß√µes adicionais</h3>
                                    <div class="form-group">
                                        <label for="description"
                                            >Descri√ß√£o (opcional)</label
                                        >
                                        <textarea
                                            class="form-control"
                                            id="description"
                                            name="description"
                                            rows="3"
                                            placeholder="Descreva seus sintomas ou motivos para a consulta..."
                                        ></textarea>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <div class="form-group">
                                        <div
                                            class="g-recaptcha"
                                            data-sitekey="{{ recaptcha_site_key }}"
                                            data-callback="onRecaptchaSuccess"
                                        ></div>
                                        <div
                                            class="invalid-feedback"
                                            data-validate-error-for="g-recaptcha-response"
                                        ></div>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button
                                        type="button"
                                        class="btn btn-pink btn-booking"
                                        id="confirmBtn"
                                        onclick="showConfirmationModal()"
                                    >
                                        Confirmar agendamento
                                    </button>
                                </div>
                                <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
                                <div id="confirmationModal" class="modal">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h2>Confirma√ß√£o de agendamento</h2>
                                            <span
                                                class="close"
                                                onclick="closeConfirmationModal()"
                                                >&times;</span
                                            >
                                        </div>
                                        <div class="modal-body">
                                            <div class="confirmation-preview">
                                                <div class="preview-section">
                                                    <h3>Dados pessoais</h3>
                                                    <div class="preview-item">
                                                        <span
                                                            class="preview-label"
                                                            >Nome:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-name"
                                                        ></span>
                                                    </div>
                                                    <div class="preview-item">
                                                        <span
                                                            class="preview-label"
                                                            >Email:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-email"
                                                        ></span>
                                                    </div>
                                                    <div class="preview-item">
                                                        <span
                                                            class="preview-label"
                                                            >Telefone:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-phone"
                                                        ></span>
                                                    </div>
                                                </div>

                                                <div class="preview-section">
                                                    <h3>
                                                        Detalhes da consulta
                                                    </h3>
                                                    <div class="preview-item">
                                                        <span
                                                            class="preview-label"
                                                            >Tipo de
                                                            consulta:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-consultation"
                                                        ></span>
                                                    </div>
                                                    <div class="preview-item">
                                                        <span
                                                            class="preview-label"
                                                            >Data:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-date"
                                                        ></span>
                                                    </div>
                                                    <div class="preview-item">
                                                        <span
                                                            class="preview-label"
                                                            >Hora:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-time"
                                                        ></span>
                                                    </div>
                                                    <div
                                                        class="preview-item"
                                                        id="preview-description-container"
                                                        style="display: none"
                                                    >
                                                        <span
                                                            class="preview-label"
                                                            >Descri√ß√£o:</span
                                                        >
                                                        <span
                                                            class="preview-value"
                                                            id="preview-description"
                                                        ></span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="confirmation-notice">
                                                <div class="notice-text">
                                                    <strong>Importante:</strong>
                                                    Por favor, certifique-se de
                                                    que todos os dados est√£o
                                                    corretos.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button
                                                type="submit"
                                                class="btn btn-pink btn-booking"
                                                data-attach-loading
                                            >
                                                Confirmar agendamento
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="booking-info-section">
                            <div class="info-card">
                                <div class="info-header">
                                    <h3>üìã Informa√ß√µes sobre o agendamento</h3>
                                </div>
                                <div class="info-content">
                                    <div class="info-item">
                                        <div class="info-text">
                                            <span
                                                >Apos a confirma√ß√£o do
                                                agendamento, voc√™ receber√° um
                                                e-mail de confirma√ß√£o junto com
                                                o link para a consulta.</span
                                            >
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="info-card">
                                <div class="info-header">
                                    <h3>Informa√ß√£o da consulta</h3>
                                </div>
                                <div
                                    class="info-content"
                                    id="consultation-features"
                                >
                                    <div class="feature-item">
                                        <span class="feature-icon">‚úì</span>
                                        <span
                                            >Selecione um tipo de consulta para
                                            ver as informa√ß√µes da consulta
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Presencial Tab -->
        <div
            class="tab-pane fade show active"
            id="presencial"
            role="tabpanel"
            aria-labelledby="presencial-tab"
        >
            <div class="">
                <div class="">
                    <div class="booking-header">
                        <p>
                            Para marcar uma consulta presencial, clique no link
                            abaixo:
                        </p>
                    </div>

                    <div class="info-card">
                        <a
                            href="{{ presencial_url }}"
                            target="_blank"
                            class="btn btn-primary pink-batton"
                            style="
                                background: linear-gradient(
                                    135deg,
                                    #2196f3,
                                    #1976d2
                                );
                                border: none;
                                padding: 12px 30px;
                                font-weight: 600;
                            "
                        >
                            Agendar Consulta Presencial
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://www.google.com/recaptcha/api.js" async defer></script>
